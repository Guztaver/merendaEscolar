<div class="container">
    <div class="header">
        <h1>{{ isEditMode() ? 'Edit Purchase' : 'New Purchase' }}</h1>
        <a [routerLink]="['/acquisition/purchases']" class="btn btn-secondary">Back to List</a>
    </div>

    <form [formGroup]="form" (ngSubmit)="onSubmit()" class="form">
        <div class="form-group">
            <label for="date">Date *</label>
            <input type="date" id="date" formControlName="date" class="form-control"
                [class.error]="form.controls.date.invalid && form.controls.date.touched">
            @if (form.controls.date.invalid && form.controls.date.touched) {
            <span class="error-message">Date is required</span>
            }
        </div>

        <div class="form-group">
            <label for="supplierId">Supplier *</label>
            <select id="supplierId" formControlName="supplierId" class="form-control"
                [class.error]="form.controls.supplierId.invalid && form.controls.supplierId.touched">
                <option value="">Select a supplier</option>
                @for (supplier of suppliers(); track supplier.id) {
                <option [value]="supplier.id">
                    {{ supplier.name }} ({{ supplier.type === 'family_farming' ? 'Family Farming' : 'Regular' }})
                </option>
                }
            </select>
            @if (form.controls.supplierId.invalid && form.controls.supplierId.touched) {
            <span class="error-message">Supplier is required</span>
            }
        </div>

        <div class="form-group">
            <label for="amount">Amount (R$) *</label>
            <input type="number" id="amount" formControlName="amount" class="form-control" step="0.01" min="0"
                [class.error]="form.controls.amount.invalid && form.controls.amount.touched">
            @if (form.controls.amount.invalid && form.controls.amount.touched) {
            <span class="error-message">Amount must be greater than 0</span>
            }
        </div>

        <div class="form-actions">
            <button type="submit" class="btn btn-primary" [disabled]="form.invalid">
                {{ isEditMode() ? 'Update' : 'Create' }}
            </button>
            <a [routerLink]="['/acquisition/purchases']" class="btn btn-secondary">Cancel</a>
        </div>
    </form>
</div>